<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
  <h2>Dashboard Carian Telefon Ibu Bapa</h2>

  <input type="text" id="searchInput" placeholder="Taip Nama Murid">
  <button onclick="searchData()">Cari</button>

  <div id="reader" style="width:300px;"></div>

  <h3 id="result"></h3>

<script>
let allData = [];

google.script.run.withSuccessHandler(function(data){
  allData = data;
}).getData();

function searchData(){
  let input = document.getElementById("searchInput").value.toLowerCase();
  let result = allData.find(row => row[0].toLowerCase().includes(input));

  if(result){
    document.getElementById("result").innerHTML =
      "Nama: " + result[0] + "<br>" +
      "Kelas: " + result[1] + "<br>" +
      "No Ibu: " + result[2] + "<br>" +
      "No Bapa: " + result[3] + "<br>" +
      "No Penjaga: " + result[4];
  } else {
    document.getElementById("result").innerHTML = "Tiada Rekod Dijumpai";
  }
}

function onScanSuccess(decodedText) {
  document.getElementById("searchInput").value = decodedText;
  searchData();
}

new Html5QrcodeScanner("reader", { fps: 10, qrbox: 250 })
.render(onScanSuccess);
</script>
</body>
</html>
